* C:\Users\shifo\OneDrive\LTspice\Projects\MOSbius\MAGamp4problem.asc
* Generated by LTspice 24.1.9 for Windows.
X§X4 BUS04 BUS01 BUS02 DP_nMOS_1x_A
X§X6 input_A BUS04 BUS05 BUS10 DP_nMOS_4x_A
V1 VDD 0 {VDD}
X§X9 BUS04 BUS03 CS_pMOS_4x_A
X§X3 BUS02 BUS05 CS_nMOS_4x_B
X§X13 NC_01 NC_02 NC_03 NC_04 DP_pMOS_4x_A
X§X8 BUS09 BUS02 BUS03 NC_05 NC_06 NC_07 NC_08 nMOS_currentMirror_array
X§X21 BUS01 chip_vdd
V2 N001 0 {vcm}
V3 N001 input_A 0
R1 VDD BUS09 {(2.5-.8)/200u}
X§X10 BUS07 BUS03 CS_pMOS_4x_B
X§X5 BUS07 BUS01 BUS06 DP_nMOS_1x_B
X§X7 input_B BUS07 BUS05 BUS10 DP_nMOS_4x_B
X§X2 BUS06 BUS05 CS_nMOS_4x_A
X§X1 BUS09 BUS06 nMOS_currentMirror
X§X14 NC_09 NC_10 NC_11 NC_12 DP_pMOS_4x_B
X§X12 BUS03 BUS03 BUS03 BUS03 NC_13 NC_14 pMOS_currentMirror_array
X§X15 NC_15 NC_16 NC_17 DP_pMOS_1x_B
X§X16 NC_18 NC_19 NC_20 DP_pMOS_1x_A
X§X11 NC_21 NC_22 pMOS_currentMirror
X§X22 BUS10 chip_vss
X§X17 BUS02 BUS03 A>B inverter_A
X§X18 BUS06 BUS03 B>A inverter_B
X§X19 NC_23 NC_24 NC_25 NC_26 OTA_nMOS
X§X20 NC_27 NC_28 NC_29 NC_30 OTA_pMOS
V4 input_B 0 {vcm}

* block symbol definitions
.subckt DP_nMOS_1x_A gate drain source
X§M1 drain gate source 0 NMOS_mobius m=1
.ends DP_nMOS_1x_A

.subckt DP_nMOS_4x_A gate drain source substrate
X§M1 drain gate source substrate NMOS_mobius m=4
.ends DP_nMOS_4x_A

.subckt CS_pMOS_4x_A drain gate
X§M1 drain gate VDD VDD PMOS_mobius m=4
.ends CS_pMOS_4x_A

.subckt CS_nMOS_4x_B gate drain
X§M1 drain gate 0 0 NMOS_mobius m=4
.ends CS_nMOS_4x_B

.subckt DP_pMOS_4x_A drain gate source nwell
X§M1 drain gate source nwell PMOS_mobius m=4
.ends DP_pMOS_4x_A

.subckt nMOS_currentMirror_array in out1 out2 out4 out8 out16 out32
X§M1 in in 0 0 NMOS_mobius m=1
X§M2 out1 in 0 0 NMOS_mobius m=1
X§M3 out2 in 0 0 NMOS_mobius m=2
X§M4 out4 in 0 0 NMOS_mobius m=4
X§M5 out8 in 0 0 NMOS_mobius m=8
X§M6 out16 in 0 0 NMOS_mobius m=16
X§M7 out32 in 0 0 NMOS_mobius m=32
.ends nMOS_currentMirror_array

.subckt chip_vdd chip_vdd
R1 chip_vdd VDD .000001
.ends chip_vdd

.subckt CS_pMOS_4x_B drain gate
X§M1 drain gate VDD VDD PMOS_mobius m=4
.ends CS_pMOS_4x_B

.subckt DP_nMOS_1x_B gate drain source
X§M1 drain gate source 0 NMOS_mobius m=1
.ends DP_nMOS_1x_B

.subckt DP_nMOS_4x_B gate drain source substrate
X§M1 drain gate source substrate NMOS_mobius m=4
.ends DP_nMOS_4x_B

.subckt CS_nMOS_4x_A gate drain
X§M1 drain gate 0 0 NMOS_mobius m=4
.ends CS_nMOS_4x_A

.subckt nMOS_currentMirror in out
X§M1 in in 0 0 NMOS_mobius m=1
X§M2 out in 0 0 NMOS_mobius m=1
.ends nMOS_currentMirror

.subckt DP_pMOS_4x_B drain gate source nwell
X§M1 drain gate source nwell PMOS_mobius m=4
.ends DP_pMOS_4x_B

.subckt pMOS_currentMirror_array in out1 out2 out4 out8 out16
X§M1 in in VDD VDD PMOS_mobius m=1
X§M2 out1 in VDD VDD PMOS_mobius m=1
X§M3 out2 in VDD VDD PMOS_mobius m=2
X§M4 out4 in VDD VDD PMOS_mobius m=4
X§M5 out8 in VDD VDD PMOS_mobius m=8
X§M6 out16 in VDD VDD PMOS_mobius m=16
.ends pMOS_currentMirror_array

.subckt DP_pMOS_1x_B drain gate source
X§M1 drain gate source VDD PMOS_mobius m=1
.ends DP_pMOS_1x_B

.subckt DP_pMOS_1x_A drain gate source
X§M1 drain gate source VDD PMOS_mobius m=1
.ends DP_pMOS_1x_A

.subckt pMOS_currentMirror gate drain
X§M1 gate gate VDD VDD PMOS_mobius m=1
X§M2 drain gate VDD VDD PMOS_mobius m=1
.ends pMOS_currentMirror

.subckt chip_vss chip_vss
R1 chip_vss 0 0.000001
.ends chip_vss

.subckt inverter_A inn inp out
X§M1 out inn 0 0 NMOS_mobius m=16
X§M2 out inp VDD VDD PMOS_mobius m=16
.ends inverter_A

.subckt inverter_B inn inp out
X§M1 out inn 0 0 NMOS_mobius m=16
X§M2 out inp VDD VDD PMOS_mobius m=16
.ends inverter_B

.subckt OTA_nMOS biasn inp inn out
X§M1 co_so biasn 0 0 NMOS_mobius m=2
X§M2 out_b inp co_so 0 NMOS_mobius m=1
X§M3 out inn co_so 0 NMOS_mobius m=1
X§M4 out out_b VDD VDD PMOS_mobius m=1
X§M5 out_b out_b VDD VDD PMOS_mobius m=1
.ends OTA_nMOS

.subckt OTA_pMOS biasp inp inn out
X§M1 co_so biasp VDD VDD PMOS_mobius m=2
X§M2 out_b inp co_so VDD PMOS_mobius m=1
X§M3 out inn co_so VDD PMOS_mobius m=1
X§M4 out_b out_b 0 0 NMOS_mobius m=1
X§M5 out out_b 0 0 NMOS_mobius m=1
.ends OTA_pMOS

.global VDD
.param VDD = 2.5
.inc transistor_models_tsmc025_public.inc
.param vcm = 1.5
.dc v3  -1.5 1.5 .01
* .op
* Digital Outputs
* Unused Parts
* EXTERNAL CONNECTIONS \ninput_A     pin 45\ninput_B     pin 42\noutput       pin 11\nR1a            ext VDD\nR1b            pin 19\nA>B            pin 51\nB>A            pin 49
* (c) Mangelsdorf 2025
* Minimum Follower Circuit
* Output follows the lower of two inputs.
* Mangelsdorf 7/26/25
.step v4 1.5 2.5 .25
.backanno
.end
